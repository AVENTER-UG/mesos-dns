<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Mesos-DNS: Mesos-DNS FAQ</title>
    <link rel="icon" type="image/x-icon" href="/mesos-dns/img/mesos-dns-favicon.ico">
    <link href="//cdn.jsdelivr.net/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="/mesos-dns/css/style.css" rel="stylesheet">
  </head>
  <body>
    <div class="container">
      <div class="row">
        <div class="col-sm-10 col-sm-offset-1">
          <div class="navbar navbar-default navbar-inverse" role="navigation">
            <div class="container-fluid">
              <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/mesos-dns/">Mesos-DNS</a>
              </div>
              <div class="collapse navbar-collapse" id="navbar-collapse">
                <ul class="nav navbar-nav">
                  <li class="active">
                    <a href="/mesos-dns/docs/">Docs</a>
                  </li>
                  <li >
                    <a href="/mesos-dns/resources.html">Resources</a>
                  </li>
                  <li >
                    <a href="/mesos-dns/support.html">Support</a>
                  </li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                  <li><a href="https://github.com/AVENTER-UG/mesos-dns">GitHub</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="row">
  <div class="col-sm-3">
    <h5>Documentation</h5>
    <ul class="list-unstyled">
      <li>
        <a href="/mesos-dns/docs/">
          Installing and running
        </a>
      </li>
       <li>
        <a href="/mesos-dns/docs/configuration-parameters.html">
        Configuration</a>
      </li>
       <li>
        <a href="/mesos-dns/docs/naming.html">
          Service Naming
        </a>
      </li>
       <li>
        <a href="/mesos-dns/docs/http.html">
          HTTP API
        </a>
      </li>
      <li>
        <a href="/mesos-dns/docs/performance-tuning.html">
          Performance Tuning
        </a>
      </li>
       <li>
        <a href="/mesos-dns/docs/faq.html">
          FAQ & Troubleshooting
        </a>
      </li>
    <hr>
    <h5>Tutorials</h5>
    <ul class="list-unstyled">
       <li>
        <a href="/mesos-dns/docs/tutorial.html">
        Mesos-DNS</a>
      </li>
       <li>
        <a href="/mesos-dns/docs/tutorial-forward.html">
        Mesos-DNS and Bind</a>
      </li>
       <li>
        <a href="/mesos-dns/docs/tutorial-systemd.html">
        Mesos-DNS using Systemd</a>
      </li>

    <hr>
    </ul>
<!---
    <h5>Resources</h5>
    <ul class="list-unstyled">
      <li>
        <a href="/mesos-dns/docs/deployment-design-doc.html">
          Deployment Design
        </a>
      </li>
    </ul>
    <hr>
    <h5>Upgrading</h5>
    <ul class="list-unstyled">
      <li>
        <a href="/mesos-dns/docs/upgrade/06xto070.html">
          0.6.x to 0.7.0
        </a>
      </li>
    </ul>
-->
  </div>
  <div class="col-sm-9">
    <h1 id="frequently-asked-questions--troubleshooting">Frequently Asked Questions &amp; Troubleshooting</h1>

<hr />

<h4 id="mesos-dns-version">Mesos-DNS version</h4>

<p>You can check the Mesos-DNS version by executing <code class="language-plaintext highlighter-rouge">mesos-dns -version</code>.</p>

<hr />

<h4 id="soa-record-customization">SOA record customization</h4>

<p>You can customize all fields in the SOA records for the Mesos domain. See the <code class="language-plaintext highlighter-rouge">SOA*</code> <a href="configuration-parameters.html">configuration parameters</a>.</p>

<hr />

<h4 id="verbose-and-very-verbose-modes">Verbose and very verbose modes</h4>

<p>If you start Mesos-DNS in verbose mode using the <code class="language-plaintext highlighter-rouge">-v=1</code> or <code class="language-plaintext highlighter-rouge">-v=2</code> arguments, it  prints a variety of messages that are useful for debugging and performance tuning. The <code class="language-plaintext highlighter-rouge">-v=2</code> option will periodically print every A or SRV record Mesos-DNS generates. In large clusters, this can overwhelm log management tools, such as <a href="http://www.freedesktop.org/software/systemd/man/systemd-journald.service.html">systemd-journald</a>, and they will drop messages. This is not a viable method to enumerate the state of a Mesos-DNS server.</p>

<hr />

<h4 id="mesos-dns-fails-to-launch">Mesos-DNS fails to launch</h4>

<p>Make sure that the port used for Mesos-DNS is available and not in use by another process. To use the recommended port <code class="language-plaintext highlighter-rouge">53</code>, you must start Mesos-DNS as root.</p>

<p>Alternatively, if you have an operating system and file system that supports <a href="http://manpages.ubuntu.com/manpages/hardy/man7/capabilities.7.html">capabilities</a>, you can run <code class="language-plaintext highlighter-rouge">sudo setcap 'cap_net_bind_service=+ep' mesos-dns</code>, which will then allow Mesos-DNS to bind to privileged ports, without requiring it to run as root.</p>

<hr />

<h4 id="slaves-cannot-connect-to-mesos-dns">Slaves cannot connect to Mesos-DNS</h4>

<p>Make sure that port <code class="language-plaintext highlighter-rouge">53</code> is not blocked by a firewall rule on your cluster. For example, <a href="https://cloud.google.com/">Google Cloud Platform</a> blocks port <code class="language-plaintext highlighter-rouge">53</code> by default. If you use the <code class="language-plaintext highlighter-rouge">zk</code> field, you should also check if the Zookeeper port is not blocked either. Finally, if you use the HTTP interface for Mesos-DNS, make sure that the <code class="language-plaintext highlighter-rouge">httpport</code> is open.</p>

<p>Check the <code class="language-plaintext highlighter-rouge">/etc/resolv.conf</code> file. If multiple nameservers are listed and Mesos-DNS is not the first one, the slave will first connect to the other name servers. If <code class="language-plaintext highlighter-rouge">options rotate</code> is used and one of the listed nameservers is not Mesos-DNS, then you will get intermittent failures.</p>

<hr />

<h4 id="mesos-dns-does-not-resolve-names-in-the-mesos-domain">Mesos-DNS does not resolve names in the Mesos domain</h4>

<p>Check the configuration file to make sure that Mesos-DNS is directed to the right Zookeeper or master(s) for the Mesos cluster (<code class="language-plaintext highlighter-rouge">masters</code>).</p>

<hr />

<h4 id="mesos-dns-does-not-resolve-names-outside-of-the-mesos-domain">Mesos-DNS does not resolve names outside of the Mesos domain</h4>

<p>Check the configuration file to make sure that Mesos-DNS is configured with the IP address of  external DNS servers (<code class="language-plaintext highlighter-rouge">resolvers</code>).</p>

<hr />

<h4 id="updating-the-configuration-file">Updating the configuration file</h4>

<p>When you update the configuration file, you need to restart Mesos-DNS. No state is lost long-term on restart as Mesos-DNS is stateless and retrieves task state from the Mesos master(s). There is a short inconsistency window where records may be missing while the zone is being generated from the <code class="language-plaintext highlighter-rouge">state.json</code>.</p>

<hr />

<h4 id="dns-names-are-not-user-friendly">DNS names are not user-friendly</h4>

<p>Some frameworks register with longer, less user-friendly names. For example, earlier versions of marathon may register with names like <code class="language-plaintext highlighter-rouge">marathon-0.7.5</code>, which will lead to names like <code class="language-plaintext highlighter-rouge">search.marathon-0.7.5.mesos</code>. Make sure your framework registers with the desired name. For instance, you can launch marathon with ` –framework_name marathon<code class="language-plaintext highlighter-rouge"> to get the framework registered as </code>marathon`.</p>

<hr />

<h4 id="mesos-dns-is-not-communicating-with-the-mesos-master-using-the-hosts-configured-in-the-masters-field">Mesos-DNS is not communicating with the Mesos Master using the hosts configured in the ‘masters’ field</h4>

<p>If the <code class="language-plaintext highlighter-rouge">zk</code> field is defined, Mesos-DNS will ignore the <code class="language-plaintext highlighter-rouge">masters</code> field. It will contact Zookeeper to detect the leading Mesos master. If the <code class="language-plaintext highlighter-rouge">zk</code> field is not used, Mesos-DNS uses the <code class="language-plaintext highlighter-rouge">masters</code> field in the configuration file only for the initial requests to the Mesos master. The initial request for task state also return information about the current masters. This information is used for subsequent task state request. If you launch Mesos-DNS in verbose mode using <code class="language-plaintext highlighter-rouge">-v=2</code>, there will be a periodic stdout message that identifies which master Mesos-DNS is contacting at the moment.</p>

  </div>
</div>

          <footer>
            <p class="text-muted">
              &copy; 2015 <a class="text-muted" href="http://mesosphere.com">Mesosphere, Inc.</a>
              &copy; 2021 <a class="text-muted" href="https://www.aventer.biz">AVENTER UG (haftungsbeschränkt).</a>
            </p>
          </footer>
        </div>
      </div>
    </div>
    <script src="//cdn.jsdelivr.net/jquery/2.1.1/jquery.min.js"></script>
    <script src="//cdn.jsdelivr.net/bootstrap/3.2.0/js/bootstrap.min.js"></script>
  </body>
</html>
