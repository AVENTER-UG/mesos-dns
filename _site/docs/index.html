<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Mesos-DNS: Installing and running Mesos-DNS</title>
    <link rel="icon" type="image/x-icon" href="/mesos-dns/img/mesos-dns-favicon.ico">
    <link href="//cdn.jsdelivr.net/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="/mesos-dns/css/style.css" rel="stylesheet">
  </head>
  <body>
    <div class="container">
      <div class="row">
        <div class="col-sm-10 col-sm-offset-1">
          <div class="navbar navbar-default navbar-inverse" role="navigation">
            <div class="container-fluid">
              <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/mesos-dns/">Mesos-DNS</a>
              </div>
              <div class="collapse navbar-collapse" id="navbar-collapse">
                <ul class="nav navbar-nav">
                  <li class="active">
                    <a href="/mesos-dns/docs/">Docs</a>
                  </li>
                  <li >
                    <a href="/mesos-dns/resources.html">Resources</a>
                  </li>
                  <li >
                    <a href="/mesos-dns/support.html">Support</a>
                  </li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                  <li><a href="https://github.com/AVENTER-UG/mesos-dns">GitHub</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="row">
  <div class="col-sm-3">
    <h5>Documentation</h5>
    <ul class="list-unstyled">
      <li>
        <a href="/mesos-dns/docs/">
          Installing and running
        </a>
      </li>
       <li>
        <a href="/mesos-dns/docs/configuration-parameters.html">
        Configuration</a>
      </li>
       <li>
        <a href="/mesos-dns/docs/naming.html">
          Service Naming
        </a>
      </li>
       <li>
        <a href="/mesos-dns/docs/http.html">
          HTTP API
        </a>
      </li>
      <li>
        <a href="/mesos-dns/docs/performance-tuning.html">
          Performance Tuning
        </a>
      </li>
       <li>
        <a href="/mesos-dns/docs/faq.html">
          FAQ & Troubleshooting
        </a>
      </li>
    <hr>
    <h5>Tutorials</h5>
    <ul class="list-unstyled">
       <li>
        <a href="/mesos-dns/docs/tutorial.html">
        Mesos-DNS</a>
      </li>
       <li>
        <a href="/mesos-dns/docs/tutorial-forward.html">
        Mesos-DNS and Bind</a>
      </li>
       <li>
        <a href="/mesos-dns/docs/tutorial-systemd.html">
        Mesos-DNS using Systemd</a>
      </li>

    <hr>
    </ul>
<!---
    <h5>Resources</h5>
    <ul class="list-unstyled">
      <li>
        <a href="/mesos-dns/docs/deployment-design-doc.html">
          Deployment Design
        </a>
      </li>
    </ul>
    <hr>
    <h5>Upgrading</h5>
    <ul class="list-unstyled">
      <li>
        <a href="/mesos-dns/docs/upgrade/06xto070.html">
          0.6.x to 0.7.0
        </a>
      </li>
    </ul>
-->
  </div>
  <div class="col-sm-9">
    <h1 id="installing-and-running-mesos-dns">Installing and running Mesos-DNS</h1>

<p>Stable binaries for the project are published via the <a href="https://github.com/AVENTER-UG/mesos-dns/releases">GitHub release channel</a>.</p>

<p>To run Mesos-DNS, you first need to install the <code class="language-plaintext highlighter-rouge">mesos-dns</code> binary somewhere on a selected server. The server can be the same machine as one of the Mesos masters, one of the slaves, or a dedicated machine on the same network. Next, follow <a href="configuration-parameters.html">these instructions</a> to create a configuration file for your cluster. You can launch Mesos-DNS with:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>mesos-dns <span class="nt">-config</span><span class="o">=</span>config.json &amp;
</code></pre></div></div>

<h2 id="mesos-dns-with-docker">Mesos-DNS with Docker</h2>

<p>If you choose to use Mesos-DNS with Docker, with a version of Mesos after 0.25, be aware that there are some caveats. By default the Docker executor publishes the IP of the Docker container into the NetworkInfo field. Unfortunately, unless you’re running some kind of SDN solution, bridged, or host networking with Docker, this can prove to make the containers unreachable.</p>

<p>The default configuration that Mesos-DNS ships with in <code class="language-plaintext highlighter-rouge">config.json.sample</code> omits <code class="language-plaintext highlighter-rouge">netinfo</code> from the sources. The default options if you omit this field from the configuration includes <code class="language-plaintext highlighter-rouge">netinfo</code>. If you have trouble with Docker, ensure you check the <code class="language-plaintext highlighter-rouge">IPSources</code> field to omit netinfo.</p>

<h2 id="slave-setup">Slave Setup</h2>

<p>To allow Mesos tasks to use Mesos-DNS as the primary DNS server, you must edit the file <code class="language-plaintext highlighter-rouge">/etc/resolv.conf</code> in every slave and add a new nameserver. For instance, if <code class="language-plaintext highlighter-rouge">mesos-dns</code> runs on the server with IP address <code class="language-plaintext highlighter-rouge">10.181.64.13</code>, you should add the line <code class="language-plaintext highlighter-rouge">nameserver 10.181.64.13</code> at the <strong><em>beginning</em></strong> of <code class="language-plaintext highlighter-rouge">/etc/resolv.conf</code> on every slave node. This can be achieve by running:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo sed</span> <span class="nt">-i</span> <span class="s1">'1s/^/nameserver 10.181.64.13\n /'</span> /etc/resolv.conf
</code></pre></div></div>

<p>If multiple instances of Mesos-DNS are launched, add a nameserver line for each one at the beginning of <code class="language-plaintext highlighter-rouge">/etc/resolv.conf</code>. The order of these entries determines the order that the slave will use to contact Mesos-DNS instances. You can set <code class="language-plaintext highlighter-rouge">options rotate</code> to instruct select between the listed nameservers in a round-robin manner for load balancing.</p>

<p>All other nameserver settings in <code class="language-plaintext highlighter-rouge">/etc/resolv.conf</code> should remain unchanged. The <code class="language-plaintext highlighter-rouge">/etc/resolv.conf</code> file in the masters should only change if the master machines are also used as slaves.</p>

<p>You can also use Mesos-DNS to serve just a <em>forward lookup zone</em> from your primary DNS server (see <a href="tutorial-forward.html">this tutorial</a>). In this case, you do not need to make any changes to the slaves in the cluster.</p>

  </div>
</div>

          <footer>
            <p class="text-muted">
              &copy; 2015 <a class="text-muted" href="http://mesosphere.com">Mesosphere, Inc.</a>
              &copy; 2021 <a class="text-muted" href="https://www.aventer.biz">AVENTER UG (haftungsbeschränkt).</a>
            </p>
          </footer>
        </div>
      </div>
    </div>
    <script src="//cdn.jsdelivr.net/jquery/2.1.1/jquery.min.js"></script>
    <script src="//cdn.jsdelivr.net/bootstrap/3.2.0/js/bootstrap.min.js"></script>
  </body>
</html>
