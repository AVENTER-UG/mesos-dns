<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Mesos-DNS: Mesos-DNS and Bind</title>
    <link rel="icon" type="image/x-icon" href="/mesos-dns/img/mesos-dns-favicon.ico">
    <link href="//cdn.jsdelivr.net/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="/mesos-dns/css/style.css" rel="stylesheet">
  </head>
  <body>
    <div class="container">
      <div class="row">
        <div class="col-sm-10 col-sm-offset-1">
          <div class="navbar navbar-default navbar-inverse" role="navigation">
            <div class="container-fluid">
              <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/mesos-dns/">Mesos-DNS</a>
              </div>
              <div class="collapse navbar-collapse" id="navbar-collapse">
                <ul class="nav navbar-nav">
                  <li class="active">
                    <a href="/mesos-dns/docs/">Docs</a>
                  </li>
                  <li >
                    <a href="/mesos-dns/resources.html">Resources</a>
                  </li>
                  <li >
                    <a href="/mesos-dns/support.html">Support</a>
                  </li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                  <li><a href="https://github.com/AVENTER-UG/mesos-dns">GitHub</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="row">
  <div class="col-sm-3">
    <h5>Documentation</h5>
    <ul class="list-unstyled">
      <li>
        <a href="/mesos-dns/docs/">
          Installing and running
        </a>
      </li>
       <li>
        <a href="/mesos-dns/docs/configuration-parameters.html">
        Configuration</a>
      </li>
       <li>
        <a href="/mesos-dns/docs/naming.html">
          Service Naming
        </a>
      </li>
       <li>
        <a href="/mesos-dns/docs/http.html">
          HTTP API
        </a>
      </li>
      <li>
        <a href="/mesos-dns/docs/performance-tuning.html">
          Performance Tuning
        </a>
      </li>
       <li>
        <a href="/mesos-dns/docs/faq.html">
          FAQ & Troubleshooting
        </a>
      </li>
    <hr>
    <h5>Tutorials</h5>
    <ul class="list-unstyled">
       <li>
        <a href="/mesos-dns/docs/tutorial.html">
        Mesos-DNS</a>
      </li>
       <li>
        <a href="/mesos-dns/docs/tutorial-forward.html">
        Mesos-DNS and Bind</a>
      </li>
       <li>
        <a href="/mesos-dns/docs/tutorial-systemd.html">
        Mesos-DNS using Systemd</a>
      </li>

    <hr>
    </ul>
<!---
    <h5>Resources</h5>
    <ul class="list-unstyled">
      <li>
        <a href="/mesos-dns/docs/deployment-design-doc.html">
          Deployment Design
        </a>
      </li>
    </ul>
    <hr>
    <h5>Upgrading</h5>
    <ul class="list-unstyled">
      <li>
        <a href="/mesos-dns/docs/upgrade/06xto070.html">
          0.6.x to 0.7.0
        </a>
      </li>
    </ul>
-->
  </div>
  <div class="col-sm-9">
    <h1 id="using-mesos-dns-as-a-forward-lookup-zone-with-bind">Using Mesos-DNS as a Forward Lookup Zone with Bind</h1>

<p>In many enterprise environments, it is difficult to change the settings for the first nameserver in every machine in the Mesos cluster and make it point to a Mesos-DNS server. You may also want to have machines outside of the Mesos cluster discover Mesos tasks using Mesos-DNS. To accommodate these cases, you can set up a <em>forward lookup zone</em> in your existing DNS server that forwards all requests in the Mesos domain to Mesos-DNS.</p>

<p>This tutorial reviews how to set up a forward lookup zone for the Mesos domain with the <a href="http://www.bind9.net">Bind9 DNS server</a>. All DNS requests will first be received by the Bind9 server. Requests in the Mesos domain will be forwarded to Mesos-DNS.</p>

<h2 id="step-1-bind9-configuration">Step 1: Bind9 Configuration</h2>

<p>Assuming that Mesos-DNS will run on host <code class="language-plaintext highlighter-rouge">192.168.0.100</code> and uses port <code class="language-plaintext highlighter-rouge">8053</code>, you can configure a Bind9 server to forward Mesos requests to Mesos-DNS by adding the following information in the <code class="language-plaintext highlighter-rouge">/etc/bind/named.conf.local</code> file:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>zone "mesos" {
  type forward;
  forward only;
  forwarders { 192.168.0.100 port 8053; };
};
</code></pre></div></div>

<p>Note that the zone name should match the domain name you selected for the Mesos cluster using the <code class="language-plaintext highlighter-rouge">domain</code> configuration parameter for Mesos-DNS.</p>

<p>You will probably need to restart your Bind9 server using a command like <code class="language-plaintext highlighter-rouge">sudo service bind9 restart</code> or <code class="language-plaintext highlighter-rouge">sudo /etc/init.d/bind9 restart</code> depending on the system. Assuming that all other machines already point to the Bind9 server as their primary nameserver, no changes are needed in any other machines.</p>

<h2 id="step-2-mesos-dns-configuration">Step 2: Mesos-DNS Configuration</h2>

<p>When you launch Mesos-DNS on host <code class="language-plaintext highlighter-rouge">192.168.0.100</code>, make sure that the following parameters are set in its configuration file:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">  </span><span class="nl">"externalon"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="err">,</span><span class="w">
  </span><span class="nl">"port"</span><span class="p">:</span><span class="w"> </span><span class="mi">8053</span><span class="err">,</span><span class="w">
</span></code></pre></div></div>

<p>Setting <code class="language-plaintext highlighter-rouge">externalon</code> to <code class="language-plaintext highlighter-rouge">false</code> instructs Mesos-DNS to refuse any requests outside of the Mesos domain. You can also skip setting the <code class="language-plaintext highlighter-rouge">resolvers</code> configuration parameter.</p>

<p>Since we now use port <code class="language-plaintext highlighter-rouge">8053</code> instead of the standard but privileged port <code class="language-plaintext highlighter-rouge">53</code>, we can run Mesos-DNS as a non-root user. This is good for security. No DNS client will be affected by the port choice since all DNS requests are first send to the Bind9 server.</p>

<h2 id="notes">Notes</h2>

<p>If you are running multiple Mesos-DNS servers for high availability, you can edit the Bind9 configuration to specify multiple forwarders for the Mesos zone.</p>

<p>Since Mesos-DNS receives requests only through the Bind9 server(s), you can limit it or firewall it to decline any connections from any other machines within the enterprise network or across the Internet. This is a good measure for security.</p>

  </div>
</div>

          <footer>
            <p class="text-muted">
              &copy; 2015 <a class="text-muted" href="http://mesosphere.com">Mesosphere, Inc.</a>
              &copy; 2021 <a class="text-muted" href="https://www.aventer.biz">AVENTER UG (haftungsbeschr√§nkt).</a>
            </p>
          </footer>
        </div>
      </div>
    </div>
    <script src="//cdn.jsdelivr.net/jquery/2.1.1/jquery.min.js"></script>
    <script src="//cdn.jsdelivr.net/bootstrap/3.2.0/js/bootstrap.min.js"></script>
  </body>
</html>
